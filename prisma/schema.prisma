datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model users {
  id        Int      @id @default(autoincrement())
  password  String
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")
  admins    admins[]
  clients   clients[]
}

model admins {
  id          Int      @id @default(autoincrement())
  email       String   @unique
  permissions String[] @default([]) @map("permissions")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @default(now()) @map("updated_at")

  userId      Int      @map("user_id")
  user        users    @relation(fields: [userId], references: [id])
}

model clients {
  id             Int              @id @default(autoincrement())
  phone          String           @unique
  preferences    String[]         @default([]) @map("preferences")
  createdAt      DateTime         @default(now()) @map("created_at")
  updatedAt      DateTime         @default(now()) @map("updated_at")

  userId         Int              @map("user_id")
  user           users            @relation(fields: [userId], references: [id])

  addressClients addressClients[]
  commands       commands[]
}

model addressClients {
  id        Int      @id @default(autoincrement())
  address   String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  clientId  Int      @map("client_id")
  client    clients  @relation(fields: [clientId], references: [id])
}

model articles {
  id           Int            @id @default(autoincrement())
  name         String
  price        Float
  description  String
  image        String
  createdAt    DateTime       @default(now()) @map("created_at")
  updatedAt    DateTime       @default(now()) @map("updated_at")

  menuArticles menuArticles[]
  articleTags  articleTags[]
  articleTypes articleTypes[]
  articleCategories articleCategories[]
}

model articleTags {
  id        Int      @id @default(autoincrement())
  articleId Int      @map("article_id")
  tagId     Int      @map("tag_id")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  article   articles @relation(fields: [articleId], references: [id])
  tag       tags     @relation(fields: [tagId], references: [id])
}

model articleTypes {
  id        Int      @id @default(autoincrement())
  articleId Int      @map("article_id")
  typeId    Int      @map("type_id")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  article   articles @relation(fields: [articleId], references: [id])
  type      types    @relation(fields: [typeId], references: [id])
}

model articleCategories {
  id         Int      @id @default(autoincrement())
  articleId  Int      @map("article_id")
  categoryId Int      @map("category_id")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @default(now()) @map("updated_at")

  article    articles @relation(fields: [articleId], references: [id])
  category   categories @relation(fields: [categoryId], references: [id])
}

model tags {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  articleTags articleTags[]
}

model types {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  articleTypes articleTypes[]
}

model categories {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  articleCategories articleCategories[]
}

model commands {
  id                  Int                   @id @default(autoincrement())
  weeks               Int
  checkedDays         String[]
  startDate           DateTime
  address             String
  status              String                @default("pending") @map("status")
  createdAt           DateTime              @default(now()) @map("created_at")
  updatedAt           DateTime              @default(now()) @map("updated_at")

  clientId            Int                   @map("client_id")
  client              clients               @relation(fields: [clientId], references: [id])

  menus               menus[]
  commandTransactions commandTransactions[]
}

model menus {
  id           Int            @id @default(autoincrement())
  createdAt    DateTime       @default(now()) @map("created_at")
  updatedAt    DateTime       @default(now()) @map("updated_at")

  commandId    Int            @map("command_id")
  command      commands       @relation(fields: [commandId], references: [id])

  menuArticles menuArticles[]
}

model menuArticles {
  id             Int              @id @default(autoincrement())
  createdAt      DateTime         @default(now()) @map("created_at")
  updatedAt      DateTime         @default(now()) @map("updated_at")

  articleId      Int              @map("article_id")
  menuId         Int              @map("menu_id")
  menu           menus            @relation(fields: [menuId], references: [id])
  article        articles         @relation(fields: [articleId], references: [id])

  planningEvents planningEvents[]
}

model planningEvents {
  id            Int          @id @default(autoincrement())
  count         Int
  date          String
  slot          String
  status        String       @default("pending") @map("status")
  createdAt     DateTime     @default(now()) @map("created_at")
  updatedAt     DateTime     @default(now()) @map("updated_at")

  menuArticleId Int          @map("menu_article_id")
  menuArticle   menuArticles @relation(fields: [menuArticleId], references: [id])
}

model commandTransactions {
  id        Int      @id @default(autoincrement())
  subtotal  Float
  shipping  Float
  tax       Float
  total     Float
  type      String   @default("payment") @map("type")
  promoCode String?
  status    String   @default("pending") @map("status")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  commandId Int      @map("command_id")
  command   commands @relation(fields: [commandId], references: [id])
}
